#include <bits/stdc++.h>
using namespace std;

struct Node{
    int data;
    Node* next;
    Node(int x){data=x; next=NULL;}
};
Node* head=NULL;

void insertBeginning(int x){
    Node* n=new Node(x);
    if(!head){
        head=n; n->next=n; return;
    }
    Node* t=head;
    while(t->next!=head) t=t->next;
    n->next=head;
    t->next=n;
    head=n;
}

void insertEnd(int x){
    Node* n=new Node(x);
    if(!head){
        head=n; n->next=n; return;
    }
    Node* t=head;
    while(t->next!=head) t=t->next;
    t->next=n;
    n->next=head;
}

void insertAfter(int key,int x){
    if(!head) return;
    Node* t=head;
    do{
        if(t->data==key){
            Node* n=new Node(x);
            n->next=t->next;
            t->next=n;
            return;
        }
        t=t->next;
    }while(t!=head);
}

void insertBefore(int key,int x){
    if(!head) return;
    if(head->data==key){
        insertBeginning(x);
        return;
    }
    Node* t=head;
    while(t->next!=head && t->next->data!=key) t=t->next;
    if(t->next==head) return;
    Node* n=new Node(x);
    n->next=t->next;
    t->next=n;
}

void deleteNode(int key){
    if(!head) return;
    if(head->data==key && head->next==head){
        head=NULL; return;
    }
    if(head->data==key){
        Node* last=head;
        while(last->next!=head) last=last->next;
        last->next=head->next;
        head=head->next;
        return;
    }
    Node* t=head;
    while(t->next!=head && t->next->data!=key) t=t->next;
    if(t->next==head) return;
    t->next=t->next->next;
}

void searchNode(int key){
    if(!head){cout<<"Not found"; return;}
    Node* t=head;
    do{
        if(t->data==key){ cout<<"Found"; return;}
        t=t->next;
    }while(t!=head);
    cout<<"Not found";
}

void display(){
    if(!head){cout<<"Empty"; return;}
    Node* t=head;
    do{
        cout<<t->data<<" ";
        t=t->next;
    }while(t!=head);
}

int main(){
    int c,x,key;
    while(cin>>c){
        if(c==1){cin>>x; insertBeginning(x);}
        else if(c==2){cin>>x; insertEnd(x);}
        else if(c==3){cin>>key>>x; insertAfter(key,x);}
        else if(c==4){cin>>key>>x; insertBefore(key,x);}
        else if(c==5){cin>>key; deleteNode(key);}
        else if(c==6){cin>>key; searchNode(key);}
        else if(c==7){display();}
        else break;
    }
}
