#include <bits/stdc++.h>
using namespace std;

struct Node{
    int data;
    Node* prev;
    Node* next;
    Node(int x){data=x;prev=next=NULL;}
};
Node* head=NULL;

void insertBeginning(int x){
    Node* n=new Node(x);
    if(!head){head=n;return;}
    n->next=head;
    head->prev=n;
    head=n;
}

void insertEnd(int x){
    Node* n=new Node(x);
    if(!head){head=n;return;}
    Node* t=head;
    while(t->next) t=t->next;
    t->next=n;
    n->prev=t;
}

void insertAfter(int key,int x){
    Node* t=head;
    while(t && t->data!=key) t=t->next;
    if(!t) return;
    Node* n=new Node(x);
    n->next=t->next;
    if(t->next) t->next->prev=n;
    n->prev=t;
    t->next=n;
}

void insertBefore(int key,int x){
    if(!head) return;
    if(head->data==key){insertBeginning(x);return;}
    Node* t=head;
    while(t && t->data!=key) t=t->next;
    if(!t) return;
    Node* n=new Node(x);
    n->prev=t->prev;
    n->next=t;
    t->prev->next=n;
    t->prev=n;
}

void deleteNode(int key){
    if(!head) return;
    if(head->data==key){
        Node* t=head;
        head=head->next;
        if(head) head->prev=NULL;
        delete t;
        return;
    }
    Node* t=head;
    while(t && t->d
